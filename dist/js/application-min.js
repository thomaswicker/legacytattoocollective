$("div.foo").toggleClass((function(){return $(this).parent().is(".bar")?"happy":"sad"}));